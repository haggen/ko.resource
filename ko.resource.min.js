/*
 * Knockout Resource v0.2 2012-06-01 10:13:24 -0300
 * by Arthur Corenzan <arthur@corenzan.com>
 * licensed under http://creativecommons.org/licenses/by/3.0
 * more on http://haggen.github.com/ko.resource
 */
(function(b,d,i){b.rest=function(f,d,g,e){b.ajax({url:d,data:g,type:f,contentType:"application/json",success:e})};d.resource=function(f,h,g){var e;g===i&&(g=h,h={});e=function(e){var a=this;a.onSave=b.noop;a.onFetch=b.noop;a.onDestroy=b.noop;b.each(g,function(c,b){a[c]=typeof b==="function"?function(){b.apply(a,arguments)}:b});a.serialize=function(){var c=d.toJS(a);b.each(c,function(a,b){(/^__/.exec(a)||typeof b==="function")&&delete c[a]});return JSON.stringify(c)};a.set=function(c){b.each(c,function(b,
c){if(typeof a[b]==="undefined")a[b]=typeof c==="function"?d.computed(c,a):typeof c==="array"?d.observableArray(c):d.observable(c);else a[b](c)})};a.save=function(){a._id?b.rest("put",f+"/"+a._id(),a.serialize(),a.onSave):b.rest("post",f,a.serialize(),function(b){a.set({_id:b._id});a.onSave(b)})};a.fetch=function(){b.rest("get",f+"/"+a._id(),null,function(b){a.set(b);a.onFetch(b)})};a.destroy=function(){b.rest("delete",f+"/"+a._id(),a.onDestroy)};a.set(h);a.set(e)};e.fetch=function(d,a){if(typeof d===
"function"){a=d;d={}}b.rest("get",f,d,function(c){a(b.map(c,function(a){return new e(a)}))})};return e}})(window.jQuery,window.ko);
