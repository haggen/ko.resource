/*
 * Knockout Resource v0.3 2012-08-16 13:31:13 -0300
 * by Arthur Corenzan <arthur@corenzan.com>
 * licensed under http://creativecommons.org/licenses/by/3.0
 * more on http://github.com/haggen/ko.resource
 */
 (function(d,i,g){var f;f=function(h,f,g,e){var a={url:f,data:g,type:h,success:e,complete:function(){console.log("Request:",a,this)}};d.ajax(a)};i.resource=function(h,j,k){var e;j===g&&(j={});k===g&&(k={});e=function(a){var b=this;a===g&&(a={});b.onSave=d.noop;b.onFetch=d.noop;b.onDestroy=d.noop;d.each(k,function(l,a){b[l]=a instanceof Function?function(){a.apply(b,arguments)}:a});b.serialize=function(){var a=i.toJS(b);d.each(a,function(b,c){0===b.indexOf("__")||c instanceof Function?delete a[b]:c instanceof
Array&&d.each(c,function(b,a){"serialize"in a&&(c[b]=a.serialize())})});return a};b.update_attributes=function(a){d.each(a,function(a,c){if(b[a]===g)b[a]=c instanceof Function?i.computed(c,b):c instanceof Array?i.observableArray(c):i.observable(c);else b[a](c)})};b.save=function(){"_id"in b?f("put",h+"/"+b._id(),b.serialize(),b.onSave):f("post",h,b.serialize(),function(a){b.update_attributes({_id:a._id});b.onSave(a)})};b.fetch=function(){f("get",h+"/"+b._id(),null,function(a){b.update_attributes(a);
b.onFetch(a)})};b.destroy=function(){f("delete",h+"/"+b._id(),b.onDestroy)};b.request=function(a,d,c,e){e===g&&(e=c,c={});f(a,h+d,c,function(a){e.apply(b,[a])})};b.update_attributes(j);b.update_attributes(a instanceof String?JSON.parse(a):a);b.initialize!==g&&b.initialize(a)};e.fetch=function(a,b){"function"===typeof a&&(b=a,a={});f("get",h,a,function(a){b(d.map(a,function(a){return new e(a)}))})};return e}})(window.jQuery,window.ko);
